{% extends 'base.html' %} {% block content %}

<div class="container">
    <main>
        <div class="col-md-8 p-3 mx-auto bg-primary bg-opacity-25 border border-info rounded">
            <h2>Manage Event</h2>
            <form method="POST" action="{{url_for('event_manage', event_id=event_id)}}">
                {{ form.hidden_tag() }}


                <div class="row g-2">

                    <!--Event Name-->
                    <div class="row-sm-6">
                        {{form.event_name.label(class='form-control-label')}}
                        {{form.event_name(class='form-control', placeholder='Event Name')}}
                        {% for error in form.event_name.errors %}
						    <div class="text-danger">{{ error }}</div>
					    {% endfor %}
                    </div>

                    <!--Event Description-->
                    <div class="row-sm-6">
                        {{form.event_description.label(class='form-control-label')}}
                        {{form.event_description(class='form-control', placeholder='Event Details')}}
                        {% for error in form.event_description.errors %}
						    <div class="text-danger">{{ error }}</div>
					    {% endfor %}
                    </div>

                    <!--Event Date : Has a date picker | Dates prior to current date are disabled-->
                    <div class="col-md-6">
                        {{form.event_date.label(class='form-control-label')}}
                        {{form.event_date(class='form-control',placeholder='Event Date')}}
                        {% for error in form.event_date.errors %}
						    <div class="text-danger">{{ error }}</div>
					    {% endfor %}
                    </div>

                    <!--Urgency Level : If I Can Id like to color code these | I could leave level 0 as default but id like to have the default selection force the user to make a selection-->
                    <div class="col-md-6">
                        {{form.urgency.label(class='form-control-label')}}
                        {{form.urgency(class='form-control',placeholder='Urgency')}}
                        {% for error in form.urgency.errors %}
						    <div class="text-danger">{{ error }}</div>
					    {% endfor %}
                    </div>

                    <!--Event Address :
                    Taken apart by 
                    Address[string] 
                    country[string/searchable selection]
                    state[searchable selection]
                    zipcode[string/int limit min/max]
                    
                    Address-->
                    <div class="col-12">
                        {{form.event_address.label(class='form-control-label')}}
                        {{form.event_address(class='form-control',placeholder='1234 Main St')}}
                        {% for error in form.event_address.errors %}
						    <div class="text-danger">{{ error }}</div>
					    {% endfor %}
                    </div>
                    <!--Country-->
                    <div class="col-md-5">
                        {{form.event_country.label(class='form-control-label')}}
                        {{form.event_country(class='form-control',placeholder='Country')}}
                        {% for error in form.event_country.errors %}
						    <div class="text-danger">{{ error }}</div>
					    {% endfor %}
                    </div>
                    <!--State-->
                    <div class="col-md-4">
                        {{form.event_state.label(class='form-control-label')}}
                        {{form.event_state(class='form-control',placeholder='State')}}
                        {% for error in form.event_state.errors %}
						    <div class="text-danger">{{ error }}</div>
					    {% endfor %}
                    </div>
                    <!--Zipcode-->
                    <div class="col-md-3">
                        {{form.event_zipcode.label(class='form-control-label')}}
                        {{form.event_zipcode(class='form-control',placeholder='Zipcode')}}
                        {% for error in form.event_zipcode.errors %}
						    <div class="text-danger">{{ error }}</div>
					    {% endfor %}
                    </div>

                    <!--Required Skills : searchable Multiselect dropdown menu-->
                    <div class="col-12 pb-3">
                        {{form.required_skills.label(class='form-control-label')}}
                        {{form.required_skills(class='form-control',placeholder='Required Skills')}}
                        {% for error in form.required_skills.errors %}
						    <div class="text-danger">{{ error }}</div>
					    {% endfor %}
                    </div>
                </div>
                <div class="py-2">
                    {{form.submit(class='w-100 btn btn-primary btn-lg')}}
                </div>
            </form>

            <!-- Display current event data -->
            <!--<h3>Current Event Data:</h3>
            <ul>
                <li>Name: {{ event.get(1)['event_name'] }}</li>
                <li>Description: {{ event.get(1)['event_description'] }}</li>
                <li>Date: {{ event.get(1)['event_date'] }}</li>
                <li>Urgency: {{ event.get(1)['urgency'] }}</li>
                <li>Address: {{ event.get(1)['event_address'] }}</li>
                <li>Country: {{ event.get(1)['event_country'] }}</li>
                <li>State: {{ event.get(1)['event_state'] }}</li>
                <li>Zipcode: {{ event.get(1)['event_zipcode'] }}</li>
                <li>Required Skills: {{ event.get(1)['required_skills'] | join(', ') }}</li>
            </ul>-->

            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    <div class="p-2 alert alert-success">
                        {% for category, message in messages %}
                            <div>{{ message|safe }}</div>
                        {% endfor %}
                    </div>
                {% endif %}
            {% endwith %}
        </div>
    </main>
</div>

<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.0/dist/jquery.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

<script>
    $(document).ready(function() {
        $('#required_skills').select2({
            theme: "bootstrap-5",
            width: $( this ).data( 'width' ) ? $( this ).data( 'width' ) : $( this ).hasClass( 'w-100' ) ? '100%' : 'style',
            placeholder: $( this ).data( 'placeholder' ),
            closeOnSelect: false,
        });

        var today = new Date().toISOString().split('T')[0];
        document.getElementById('event_date').setAttribute('min', today);
    });
</script>

{% endblock %}